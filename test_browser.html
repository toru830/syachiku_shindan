<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>診断分布テスト</title>
</head>
<body>
    <h1>診断分布テスト</h1>
    <button id="test-btn">1000回テスト実行</button>
    <div id="results"></div>

    <script>
        // 結果タイプ（簡略版）
        const resultTypes = [
            { name: "生粋の社畜", index: 0 },
            { name: "バーンアウト予備軍", index: 1 },
            { name: "ストイック社畜", index: 2 },
            { name: "一匹狼ワーカー", index: 3 },
            { name: "心優しき社畜", index: 4 },
            { name: "繊細ワーカー", index: 5 },
            { name: "チームプレイヤー", index: 6 },
            { name: "マイペース社員", index: 7 },
            { name: "ゆるふわ社畜", index: 8 },
            { name: "デキる社員", index: 9 },
            { name: "お人好し社員", index: 10 },
            { name: "現実派社員", index: 11 },
            { name: "ライフワークバランス", index: 12 },
            { name: "自由人", index: 13 },
            { name: "普通の社員", index: 14 },
            { name: "その他", index: 15 }
        ];

        // 修正後のパターンマップ
        const patternMap = {
            'high-high-high-high': resultTypes[0],   // 生粋の社畜（レア）
            'high-high-high-low': resultTypes[2],    // ストイック社畜
            'high-high-high-medium': resultTypes[0], // 生粋の社畜（レア）
            'high-high-low-high': resultTypes[6],    // チームプレイヤー
            'high-high-low-low': resultTypes[3],     // 一匹狼ワーカー
            'high-high-low-medium': resultTypes[6],  // チームプレイヤー
            'high-high-medium-high': resultTypes[1], // バーンアウト予備軍
            'high-high-medium-low': resultTypes[2],  // ストイック社畜
            'high-high-medium-medium': resultTypes[9], // デキる社員
            'high-medium-high-high': resultTypes[4], // 心優しき社畜
            'high-medium-high-low': resultTypes[5],  // 繊細ワーカー
            'high-medium-high-medium': resultTypes[4], // 心優しき社畜
            'high-medium-low-high': resultTypes[6],  // チームプレイヤー
            'high-medium-low-low': resultTypes[3],   // 一匹狼ワーカー
            'high-medium-low-medium': resultTypes[3], // 一匹狼ワーカー
            'high-medium-medium-high': resultTypes[4], // 心優しき社畜
            'high-medium-medium-low': resultTypes[5], // 繊細ワーカー
            'high-medium-medium-medium': resultTypes[7], // マイペース社員
            'high-low-high-high': resultTypes[4],    // 心優しき社畜
            'high-low-high-low': resultTypes[5],     // 繊細ワーカー
            'high-low-high-medium': resultTypes[5],  // 繊細ワーカー
            'high-low-low-high': resultTypes[3],     // 一匹狼ワーカー
            'high-low-low-low': resultTypes[3],      // 一匹狼ワーカー
            'high-low-low-medium': resultTypes[3],   // 一匹狼ワーカー
            'high-low-medium-high': resultTypes[6],  // チームプレイヤー
            'high-low-medium-low': resultTypes[15],  // 自由人（レア）
            'high-low-medium-medium': resultTypes[7], // マイペース社員
            'medium-high-high-high': resultTypes[1], // バーンアウト予備軍
            'medium-high-high-low': resultTypes[8],  // ゆるふわ社畜
            'medium-high-high-medium': resultTypes[9], // 隠れ疲労タイプ
            'medium-high-low-high': resultTypes[10], // お人好し社員
            'medium-high-low-low': resultTypes[11],  // 現実派社員
            'medium-high-low-medium': resultTypes[11], // 現実派社員
            'medium-high-medium-high': resultTypes[10], // お人好し社員
            'medium-high-medium-low': resultTypes[10], // お人好し社員
            'medium-high-medium-medium': resultTypes[9], // 隠れ疲労タイプ
            'medium-medium-high-high': resultTypes[9], // 隠れ疲労タイプ
            'medium-medium-high-low': resultTypes[8], // ゆるふわ社畜
            'medium-medium-high-medium': resultTypes[1], // バーンアウト予備軍
            'medium-medium-low-high': resultTypes[12], // 家庭が大事
            'medium-medium-low-low': resultTypes[14], // デキる社員
            'medium-medium-low-medium': resultTypes[13], // ライフワークバランス
            'medium-medium-medium-high': resultTypes[10], // お人好し社員
            'medium-medium-medium-low': resultTypes[11], // 現実派社員
            'medium-medium-medium-medium': resultTypes[11], // 現実派社員
            'medium-low-high-high': resultTypes[12], // 家庭が大事
            'medium-low-high-low': resultTypes[13],  // ライフワークバランス
            'medium-low-high-medium': resultTypes[8], // ゆるふわ社畜
            'medium-low-low-high': resultTypes[14],  // デキる社員
            'medium-low-low-low': resultTypes[14],   // デキる社員
            'medium-low-low-medium': resultTypes[14], // デキる社員
            'medium-low-medium-high': resultTypes[12], // 家庭が大事
            'medium-low-medium-low': resultTypes[0], // 生粋の社畜（レア移動）
            'medium-low-medium-medium': resultTypes[7], // マイペース社員
            'low-high-high-high': resultTypes[8],    // ゆるふわ社畜
            'low-high-high-low': resultTypes[8],     // ゆるふわ社畜
            'low-high-high-medium': resultTypes[9],  // 隠れ疲労タイプ
            'low-high-low-high': resultTypes[10],    // お人好し社員
            'low-high-low-low': resultTypes[11],     // 現実派社員
            'low-high-low-medium': resultTypes[11],  // 現実派社員
            'low-high-medium-high': resultTypes[10], // お人好し社員
            'low-high-medium-low': resultTypes[8],   // ゆるふわ社畜
            'low-high-medium-medium': resultTypes[12], // ライフワークバランス
            'low-medium-high-high': resultTypes[4],  // 心優しき社畜
            'low-medium-high-low': resultTypes[5],   // 繊細ワーカー
            'low-medium-high-medium': resultTypes[4], // 心優しき社畜
            'low-medium-low-high': resultTypes[6],   // チームプレイヤー
            'low-medium-low-low': resultTypes[3],    // 一匹狼ワーカー
            'low-medium-low-medium': resultTypes[3], // 一匹狼ワーカー
            'low-medium-medium-high': resultTypes[4], // 心優しき社畜
            'low-medium-medium-low': resultTypes[5], // 繊細ワーカー
            'low-medium-medium-medium': resultTypes[7], // マイペース社員
            'low-low-high-high': resultTypes[4],     // 心優しき社畜
            'low-low-high-low': resultTypes[5],      // 繊細ワーカー
            'low-low-high-medium': resultTypes[4],   // 心優しき社畜
            'low-low-low-high': resultTypes[6],      // チームプレイヤー
            'low-low-low-low': resultTypes[13],      // 自由人（レア）
            'low-low-low-medium': resultTypes[3],    // 一匹狼ワーカー
            'low-low-medium-high': resultTypes[4],   // 心優しき社畜
            'low-low-medium-low': resultTypes[5],    // 繊細ワーカー
            'low-low-medium-medium': resultTypes[7]  // マイペース社員
        };

        function calculateScores(answers) {
            const scores = { dedication: 0, sacrifice: 0, stress: 0, relationship: 0 };
            
            for (let i = 0; i < answers.length; i++) {
                const answer = answers[i];
                if (answer >= 3) {
                    // ランダムに軸を選択してスコアを追加
                    const axes = ['dedication', 'sacrifice', 'stress', 'relationship'];
                    const axis = axes[Math.floor(Math.random() * axes.length)];
                    scores[axis] += answer;
                }
            }
            
            return scores;
        }

        function normalizeScores(scores) {
            const maxPossible = 16 * 5;
            return {
                dedication: Math.round((scores.dedication / maxPossible) * 100),
                sacrifice: Math.round((scores.sacrifice / maxPossible) * 100),
                stress: Math.round((scores.stress / maxPossible) * 100),
                relationship: Math.round((scores.relationship / maxPossible) * 100)
            };
        }

        function getLevel(score) {
            if (score >= 60) return 'high';
            if (score >= 35) return 'medium';
            return 'low';
        }

        function getResultType(normalizedScores) {
            const dedicationLevel = getLevel(normalizedScores.dedication);
            const sacrificeLevel = getLevel(normalizedScores.sacrifice);
            const stressLevel = getLevel(normalizedScores.stress);
            const relationshipLevel = getLevel(normalizedScores.relationship);
            
            const pattern = `${dedicationLevel}-${sacrificeLevel}-${stressLevel}-${relationshipLevel}`;
            const result = patternMap[pattern] || resultTypes[14];
            
            return result;
        }

        function runTest() {
            const results = {};
            const patternCounts = {};
            
            console.log('=== 修正後 1000回診断テスト開始 ===');
            
            for (let i = 0; i < 1000; i++) {
                const answers = Array(16).fill(0).map(() => Math.floor(Math.random() * 6));
                const scores = calculateScores(answers);
                const normalizedScores = normalizeScores(scores);
                const result = getResultType(normalizedScores);
                
                results[result.name] = (results[result.name] || 0) + 1;
                
                const dedicationLevel = getLevel(normalizedScores.dedication);
                const sacrificeLevel = getLevel(normalizedScores.sacrifice);
                const stressLevel = getLevel(normalizedScores.stress);
                const relationshipLevel = getLevel(normalizedScores.relationship);
                const pattern = `${dedicationLevel}-${sacrificeLevel}-${stressLevel}-${relationshipLevel}`;
                patternCounts[pattern] = (patternCounts[pattern] || 0) + 1;
            }
            
            console.log('\n=== 結果分布 ===');
            const sortedResults = Object.entries(results).sort(([,a], [,b]) => b - a);
            let html = '<h2>結果分布</h2><ul>';
            
            sortedResults.forEach(([name, count]) => {
                const percentage = ((count / 1000) * 100).toFixed(1);
                console.log(`${name}: ${count}回 (${percentage}%)`);
                html += `<li><strong>${name}</strong>: ${count}回 (${percentage}%)</li>`;
            });
            
            html += '</ul>';
            
            console.log('\n=== ストイック社畜の出現パターン ===');
            html += '<h2>ストイック社畜の出現パターン</h2><ul>';
            
            Object.entries(patternCounts).forEach(([pattern, count]) => {
                if (patternMap[pattern] && patternMap[pattern].name === 'ストイック社畜') {
                    const percentage = ((count / 1000) * 100).toFixed(1);
                    console.log(`${pattern}: ${count}回 (${percentage}%)`);
                    html += `<li><strong>${pattern}</strong>: ${count}回 (${percentage}%)</li>`;
                }
            });
            
            html += '</ul>';
            
            document.getElementById('results').innerHTML = html;
        }

        document.getElementById('test-btn').addEventListener('click', runTest);
    </script>
</body>
</html>
